<%@ page language="java" contentType="text/html; charset=EUC-KR"
	pageEncoding="EUC-KR"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>

<div id="wrapper">
<link rel="stylesheet" type="text/css" href="style.css" media="all" />
<!--[if IE 7]>
<link rel="stylesheet" type="text/css" href="style/css/ie7.css" media="all" />
<![endif]-->
<script type="text/javascript" src="style/js/jquery-1.5.min.js"></script>
<script type="text/javascript" src="style/js/jquery.jcarousel.js"></script>
<script type="text/javascript" src="style/js/newscarousel.js"></script>
    <div id="news"> 
      
      <!-- Begin News Navigation -->
      <div id="newslist">
        <ul>
          <!-- Begin Entry Heading 1 -->
          <li> <a href="#"><img src="style/images/img.jpg" alt="" class="left" /></a>
            <h4 class="title"><a href="#">1 - My First Journal Entry</a></h4>
            <p>Suspendisse malesuada diam quis enim dictum nec gravida nisl gravida. Quisque lobortis gravida elit ac dapibus. Ut felis lorem, tris tique ac cursus vitae, pretium ac est. Cras nisl orci, luctus ullamcorper laoreet eget, cursus at lacus. <a href="#" class="more">Continue Reading &raquo;</a> </p>
          </li>
          <!-- End Entry Heading 1 --> 
          
          <!-- Begin Entry Heading 2 -->
          <li> <a href="#"><img src="style/images/img.jpg" alt="" class="left" /></a>
            <h4 class="title"><a href="#">2 - My First Journal Entry</a></h4>
            <p>Suspendisse malesuada diam quis enim dictum nec gravida nisl gravida. Quisque lobortis gravida elit ac dapibus. Ut felis lorem, tris tique ac cursus vitae, pretium ac est. Cras nisl orci, luctus ullamcorper laoreet eget, cursus at lacus. <a href="#" class="more">Continue Reading &raquo;</a> </p>
          </li>
          <!-- End Entry Heading 2 --> 
          
          <!-- Begin Entry Heading 3 -->
          <li> <a href="#"><img src="style/images/img.jpg" alt="" class="left" /></a>
            <h4 class="title"><a href="#">3 - My First Journal Entry</a></h4>
            <p>Suspendisse malesuada diam quis enim dictum nec gravida nisl gravida. Quisque lobortis gravida elit ac dapibus. Ut felis lorem, tris tique ac cursus vitae, pretium ac est. Cras nisl orci, luctus ullamcorper laoreet eget, cursus at lacus. <a href="#" class="more">Continue Reading &raquo;</a> </p>
          </li>
          <!-- End Entry Heading 3 --> 
          
          <!-- Begin Entry Heading 4 -->
          <li> <a href="#"><img src="style/images/img.jpg" alt="" class="left" /></a>
            <h4 class="title"><a href="#">4 - My First Journal Entry</a></h4>
            <p>Suspendisse malesuada diam quis enim dictum nec gravida nisl gravida. Quisque lobortis gravida elit ac dapibus. Ut felis lorem, tris tique ac cursus vitae, pretium ac est. Cras nisl orci, luctus ullamcorper laoreet eget, cursus at lacus. <a href="#" class="more">Continue Reading &raquo;</a> </p>
          </li>
          <!-- End Entry Heading 4 --> 
          
          <!-- Begin Entry Heading 5 -->
          <li> <a href="#"><img src="style/images/img.jpg" alt="" class="left" /></a>
            <h4 class="title"><a href="#">5 - My First Journal Entry</a></h4>
            <p>Suspendisse malesuada diam quis enim dictum nec gravida nisl gravida. Quisque lobortis gravida elit ac dapibus. Ut felis lorem, tris tique ac cursus vitae, pretium ac est. Cras nisl orci, luctus ullamcorper laoreet eget, cursus at lacus. <a href="#" class="more">Continue Reading &raquo;</a> </p>
          </li>
          <!-- End Entry Heading 5 --> 
          
          <!-- Begin Entry Heading 6 -->
          <li> <a href="#"><img src="style/images/img.jpg" alt="" class="left" /></a>
            <h4 class="title"><a href="#">6 - My First Journal Entry</a></h4>
            <p>Suspendisse malesuada diam quis enim dictum nec gravida nisl gravida. Quisque lobortis gravida elit ac dapibus. Ut felis lorem, tris tique ac cursus vitae, pretium ac est. Cras nisl orci, luctus ullamcorper laoreet eget, cursus at lacus. <a href="#" class="more">Continue Reading &raquo;</a> </p>
          </li>
          <!-- End Entry Heading 6 --> 
          
          <!-- Begin Entry Heading 7 -->
          <li> <a href="#"><img src="style/images/img.jpg" alt="" class="left" /></a>
            <h4 class="title"><a href="#">7 - My First Journal Entry</a></h4>
            <p>Suspendisse malesuada diam quis enim dictum nec gravida nisl gravida. Quisque lobortis gravida elit ac dapibus. Ut felis lorem, tris tique ac cursus vitae, pretium ac est. Cras nisl orci, luctus ullamcorper laoreet eget, cursus at lacus. <a href="#" class="more">Continue Reading &raquo;</a> </p>
          </li>
          <!-- End Entry Heading 7 --> 
          
          <!-- Begin Entry Heading 8 -->
          <li> <a href="#"><img src="style/images/img.jpg" alt="" class="left" /></a>
            <h4 class="title"><a href="#">8 - My First Journal Entry</a></h4>
            <p>Suspendisse malesuada diam quis enim dictum nec gravida nisl gravida. Quisque lobortis gravida elit ac dapibus. Ut felis lorem, tris tique ac cursus vitae, pretium ac est. Cras nisl orci, luctus ullamcorper laoreet eget, cursus at lacus. <a href="#" class="more">Continue Reading &raquo;</a> </p>
          </li>
          <!-- End Entry Heading 8 --> 
          
          <!-- Begin Entry Heading 9 -->
          <li> <a href="#"><img src="style/images/img.jpg" alt="" class="left" /></a>
            <h4 class="title"><a href="#">9 - My First Journal Entry</a></h4>
            <p>Suspendisse malesuada diam quis enim dictum nec gravida nisl gravida. Quisque lobortis gravida elit ac dapibus. Ut felis lorem, tris tique ac cursus vitae, pretium ac est. Cras nisl orci, luctus ullamcorper laoreet eget, cursus at lacus. <a href="#" class="more">Continue Reading &raquo;</a> </p>
          </li>
          <!-- End Entry Heading 9 --> 
          
          <!-- Begin Entry Heading 10 -->
          <li> <a href="#"><img src="style/images/img.jpg" alt="" class="left" /></a>
            <h4 class="title"><a href="#">10 - My First Journal Entry</a></h4>
            <p>Suspendisse malesuada diam quis enim dictum nec gravida nisl gravida. Quisque lobortis gravida elit ac dapibus. Ut felis lorem, tris tique ac cursus vitae, pretium ac est. Cras nisl orci, luctus ullamcorper laoreet eget, cursus at lacus. <a href="#" class="more">Continue Reading &raquo;</a> </p>
          </li>
          <!-- End Entry Heading 10 -->
          
        </ul>
      </div>
      <div class="clearfix"></div>
      <div id="scroll"> <a href="#" id="newslist-prev" class="jbutton"></a> <a href="#" id="newslist-next" class="jbutton"></a> </div>
      <div class="clearfix"></div>
    </div>
    <!-- End News Navigation --> 
    
  </div>
  <div class="clearfix"></div>
</div>






<div class="container">
	<div class="col-md-10">

		<table class="table table-bordered">
			<c:forEach var="i" begin="0" end="${size-1 }">
				<tr>
					<td>
						<div class="media">

							<div class="col-md-3">
								<img src="/img.jpg" class="img-circle" width="90%">
								${review[i].EMAIL }
							</div>
							<div class="col-md-9">
								<a href="/company/detail?cmpn_nm=${review[i].CMPN_NM }"><h4>
										<b>${review[i].CMPN_NM }<b />
									</h4></a>


								<p>${ review[i].CONTENTS}</p>
							</div>
					</td>
					</div>
					</td>
				</tr>
			</c:forEach>

		</table>
		<div align="center" class="well">
			<c:if test="${page ne 1 }">
				<a href="/review/list_form?page=${page -1 }">이전</a>
			</c:if>
			<c:forEach var="p" begin="1" end="${size }" varStatus="vs">
				<c:choose>
					<c:when test="${p eq page }">
						<b style="color: red;">${p }</b>
					</c:when>
					<c:otherwise>
						<a href="/review/list_form?page=${p }">${p }</a>
					</c:otherwise>
				</c:choose>
				<c:if test="${vs.last eq false }">|</c:if>
			</c:forEach>
			<c:if test="${page ne size }">
				<a href="/review/list_form?page=${page +1 }">다음</a>
			</c:if>
		</div>
	</div>

	<style>
input[id=msg] {
	width: 30%;
}
</style>
	<div class="col-md-2">
		<div class="container">
			<div class="well" id="result"
				style="height: 40%; width: 30%; overflow-y: scroll; margin-top: 0px; background: gray;"></div>
			<div>
				<input type="text" class="form-control" id="msg" placeholder="남길내용" />
			</div>
		</div>
	</div>
</div>

<script>
	document.getElementById("msg").onkeyup = function(e) {
		if (e.key == 'Enter') {
			var xhr = new XMLHttpRequest();

			xhr.open("get", "/chat/chatAjax?msg=" + this.value, true);
			xhr.send();
			this.value = "";
		}
	}

	function getChatLog() {
		var xhr = new XMLHttpRequest();
		xhr.open("get", "/chat/logAjax", true);
		xhr.send();
		xhr.onreadystatechange = function() {
			if (xhr.readyState == 4 && xhr.status == 200) {
				var obj = JSON.parse(xhr.responseText);
				var html = "";
				for (var i = 0; i < obj.length; i++) {
					html += "<b>[" + obj[i].id + "]</b> ";
					html += obj[i].msg + "<br>";
				}
				console.log(document.getElementById("result").innerHTML);
				console.log(html);
				if (document.getElementById("result").innerHTML != html) {
					document.getElementById("result").innerHTML = html;
					document.getElementById("result").scrollTop = document
							.getElementById("result").scrollHeight;
				}
			}
		}
	}
	setInterval(getChatLog, 200);
</script>


